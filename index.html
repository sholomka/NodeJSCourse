<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<form id="POST">
    <input type="file" name="file">
    <input type="submit" value="Загрузить">
</form>

<form id="DELETE">
    <input type="text" name="file" placeholder="filename.ext">
    <input type="submit" value="Удалить">
</form>

<form id="GET">
    <input type="text" name="file" placeholder="filename.ext">
    <input type="submit" value="Загрузить">
</form>


<div id="messages"></div>

<script>
    document.onsubmit = (event) => {
        event.preventDefault();

        let form = event.target;
        if (!form.file.value) return;


        let fileUrl = 'files/' + form.file.value.replace(/.*[\\\/]/, '');


        let xhr = new XMLHttpRequest();

        xhr.onload = () => {
            console.log(`${xhr.status}: ${xhr.responseText}` );
            let p = document.createElement('p');
            p.textContent = xhr.responseText;
            messages.appendChild(p);
        };

        console.log(fileUrl);


        switch(event.target.id) {
            case 'GET':
                xhr.open('GET', fileUrl);
                xhr.send('');
                break;
            case 'POST':
                xhr.open('POST', '/publish', true);
                xhr.send(JSON.stringify({message: message.value}));
                message.value = '';
                break;
        }
    };


   /* publish.onsubmit = () => {
      let xhr = new XMLHttpRequest();
      xhr.open('POST', '/publish', true);
      xhr.send(JSON.stringify({message: message.value}));
      message.value = '';
      return false;
    };

    let subscribe = () => {
        let xhr = new XMLHttpRequest();
        xhr.open('GET', '/subscribe', true);

        xhr.onload = () => {
            let li = document.createElement('li');
            li.textContent = this.responseText;
            messages.appendChild(li);
            subscribe();
        };

        xhr.onerror = xhr.onabort = () => {
            setTimeout(subscribe, 500);
        };

        xhr.send('');
    };

    subscribe();*/

</script>


</body>
</html>